<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<ScrollPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="org.example.se302.controller.ScheduleCalendarController"
            fitToWidth="true" fitToHeight="true"
            hbarPolicy="AS_NEEDED" vbarPolicy="AS_NEEDED">
    
    <BorderPane styleClass="content-pane">
        <top>
            <VBox spacing="20">
                <padding>
                    <Insets top="40" right="40" bottom="20" left="40"/>
                </padding>
                
                <!-- Page Title -->
                <VBox spacing="8">
                    <Label text="ðŸ“… Auto Schedule Generator" styleClass="section-title"/>
                    <Label text="Configure and generate an optimized exam schedule using CSP algorithm with intelligent heuristics." 
                           wrapText="true" styleClass="description-label"/>
                </VBox>
                
                <Separator/>
                
                <!-- Configuration Panel -->
                <VBox spacing="20" styleClass="config-panel">
                    <Label text="âš™ï¸ Schedule Configuration" styleClass="subsection-title"/>
                    
                    <!-- Row 1: Time Configuration -->
                    <GridPane hgap="16" vgap="12">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                        </columnConstraints>
                        
                        <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Number of Days" styleClass="stat-label"/>
                            <Spinner fx:id="numDaysSpinner" editable="true" prefWidth="120"/>
                        </VBox>
                        
                        <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Slots per Day" styleClass="stat-label"/>
                            <Spinner fx:id="slotsPerDaySpinner" editable="true" prefWidth="120"/>
                        </VBox>
                        
                        <VBox spacing="6" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Start Date" styleClass="stat-label"/>
                            <DatePicker fx:id="startDatePicker" promptText="Select Date" prefWidth="150"/>
                        </VBox>
                        
                        <VBox spacing="6" GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <Label text="Slot Duration (min)" styleClass="stat-label"/>
                            <Spinner fx:id="slotDurationSpinner" editable="true" prefWidth="120"/>
                        </VBox>
                        
                        <!-- Row 2: Strategy Configuration -->
                        <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2">
                            <Label text="Optimization Strategy" styleClass="stat-label"/>
                            <ComboBox fx:id="strategyComboBox" prefWidth="250" promptText="Select Strategy"/>
                        </VBox>
                        
                        <VBox spacing="6" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <Label text="Day Start Time" styleClass="stat-label"/>
                            <ComboBox fx:id="startTimeComboBox" prefWidth="120" promptText="09:00"/>
                        </VBox>
                        
                        <VBox spacing="6" alignment="CENTER_LEFT" GridPane.columnIndex="3" GridPane.rowIndex="1">
                            <Label text="Options" styleClass="stat-label"/>
                            <CheckBox fx:id="allowBackToBackCheckBox" text="Allow back-to-back" selected="true"/>
                        </VBox>
                    </GridPane>
                    
                    <!-- Summary -->
                    <HBox spacing="12" alignment="CENTER_LEFT" styleClass="summary-row">
                        <Label text="ðŸ“Š Total Time Slots:" style="-fx-font-weight: 700;"/>
                        <Label fx:id="summaryLabel" text="8 days Ã— 4 slots = 32 slots"
                               styleClass="summary-value"/>
                    </HBox>
                </VBox>
                
                <Separator/>
                
                <!-- Action Bar -->
                <HBox spacing="16" alignment="CENTER_LEFT">
                    <Button fx:id="generateButton" text="ðŸš€ Generate Schedule" 
                            onAction="#onGenerateSchedule" styleClass="primary-button"/>
                    <Button fx:id="cancelButton" text="Cancel" onAction="#onCancelGeneration" 
                            disable="true"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label fx:id="statusLabel" text="Ready" styleClass="status-label"/>
                </HBox>
                
                <!-- Progress Container -->
                <VBox fx:id="progressContainer" spacing="12" visible="false" managed="false"
                      styleClass="card">
                    <HBox spacing="16" alignment="CENTER_LEFT">
                        <ProgressIndicator fx:id="progressIndicator" prefWidth="32" prefHeight="32"/>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label fx:id="progressLabel" text="Initializing..." 
                                   style="-fx-font-weight: 700; -fx-font-size: 14px;"/>
                            <ProgressBar fx:id="progressBar" prefWidth="400" progress="0" maxWidth="Infinity"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="progressDetailLabel" text="Please wait..." 
                           style="-fx-text-fill: -fx-slate-600; -fx-font-size: 12px;"/>
                </VBox>
            </VBox>
        </top>
        
        <center>
            <VBox spacing="20">
                <padding>
                    <Insets top="20" right="40" bottom="40" left="40"/>
                </padding>
                
                <!-- Schedule Grid Header -->
                <HBox spacing="12" alignment="CENTER_LEFT">
                    <Label text="ðŸ“† Generated Schedule" styleClass="subsection-title"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button fx:id="exportButton" text="ðŸ“¥ Export CSV" onAction="#onExportCSV" styleClass="small-button"/>
                </HBox>
                
                <!-- Schedule Grid -->
                <ScrollPane fx:id="scheduleScrollPane" fitToWidth="true" fitToHeight="false"
                            prefHeight="500" minHeight="300"
                            hbarPolicy="ALWAYS" vbarPolicy="ALWAYS"
                            VBox.vgrow="ALWAYS"
                            style="-fx-background: -fx-surface; -fx-border-color: -fx-slate-200; -fx-border-width: 1; -fx-border-radius: 24; -fx-background-radius: 24;">
                    <GridPane fx:id="scheduleGrid" gridLinesVisible="true" styleClass="schedule-grid"
                              minWidth="800" minHeight="400">
                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>
                        <Label text="Click 'Generate Schedule' to create an exam schedule" 
                               GridPane.columnIndex="0" GridPane.rowIndex="0" 
                               styleClass="placeholder-text" wrapText="true"/>
                    </GridPane>
                </ScrollPane>
                
                <!-- Statistics Panel -->
                <HBox spacing="24" alignment="CENTER_LEFT" styleClass="stats-panel">
                    <VBox spacing="4" alignment="CENTER">
                        <Label fx:id="totalCoursesLabel" text="0" styleClass="stat-value"/>
                        <Label text="Total Courses" styleClass="stat-label"/>
                    </VBox>
                    <Separator orientation="VERTICAL"/>
                    <VBox spacing="4" alignment="CENTER">
                        <Label fx:id="scheduledCoursesLabel" text="0" styleClass="stat-value"/>
                        <Label text="Scheduled" styleClass="stat-label"/>
                    </VBox>
                    <Separator orientation="VERTICAL"/>
                    <VBox spacing="4" alignment="CENTER">
                        <Label fx:id="classroomsUsedLabel" text="0" styleClass="stat-value"/>
                        <Label text="Classrooms Used" styleClass="stat-label"/>
                    </VBox>
                    <Separator orientation="VERTICAL"/>
                    <VBox spacing="4" alignment="CENTER">
                        <Label fx:id="generationTimeLabel" text="-" styleClass="stat-value"/>
                        <Label text="Generation Time" styleClass="stat-label"/>
                    </VBox>
                </HBox>
            </VBox>
        </center>
    </BorderPane>
</ScrollPane>
